{"version":3,"file":"cipher.js","sources":["../../../../src/utils/cipher.ts"],"sourcesContent":["import { decrypt, encrypt } from 'crypto-js/aes';\nimport UTF8, { parse } from 'crypto-js/enc-utf8';\nimport pkcs7 from 'crypto-js/pad-pkcs7';\nimport ECB from 'crypto-js/mode-ecb';\nimport md5 from 'crypto-js/md5';\n\nimport Base64 from 'crypto-js/enc-base64';\n\nexport interface EncryptionParams {\n  key: string\n  iv: string\n}\n\n/**\n * AES 加密解密\n */\nexport class AesEncryption {\n  private key;\n\n  private iv;\n\n  constructor(opt: Partial<EncryptionParams> = {}) {\n    const { key, iv } = opt;\n    if (key) {\n      this.key = parse(key);\n    }\n    if (iv) {\n      this.iv = parse(iv);\n    }\n  }\n\n  get getOptions() {\n    return {\n      mode: ECB,\n      padding: pkcs7,\n      iv: this.iv,\n    };\n  }\n\n  encryptByAES(cipherText: string) {\n    return encrypt(cipherText, this.key!, this.getOptions).toString();\n  }\n\n  decryptByAES(cipherText: string) {\n    return decrypt(cipherText, this.key!, this.getOptions).toString(UTF8);\n  }\n}\n\n/**\n * Base64加密\n * @param cipherText\n */\nexport function encryptByBase64(cipherText: string) {\n  return UTF8.parse(cipherText).toString(Base64);\n}\n\n/**\n * Base64解密\n * @param cipherText\n */\nexport function decodeByBase64(cipherText: string) {\n  return Base64.parse(cipherText).toString(UTF8);\n}\n\n/**\n * MD5加密\n * @param password\n */\nexport function encryptByMd5(password: string) {\n  return md5(password).toString();\n}\n"],"names":["parse","ECB","pkcs7","encrypt","decrypt","UTF8"],"mappings":";;;;AAgBO,MAAA,gBAAA,QAAA,qBAAA;AAAA,MAAM,cAAc;AAAA,EAKzB,YAAY,MAAiC,IAAI;AAJzC;AAEA;AAGA,UAAA,EAAE,KAAK,GAAO,IAAA;AACpB,QAAI,KAAK;AACF,WAAA,MAAMA,sBAAM,GAAG;AAAA,IACtB;AACA,QAAI,IAAI;AACD,WAAA,KAAKA,sBAAM,EAAE;AAAA,IACpB;AAAA,EACF;AAAA,EAEA,IAAI,aAAa;AACR,WAAA;AAAA,MACL,MAAMC,cAAA;AAAA,MACN,SAASC,cAAA;AAAA,MACT,IAAI,KAAK;AAAA,IAAA;AAAA,EAEb;AAAA,EAEA,aAAa,YAAoB;AAC/B,WAAOC,wBAAQ,YAAY,KAAK,KAAM,KAAK,UAAU,EAAE;EACzD;AAAA,EAEA,aAAa,YAAoB;AACxB,WAAAC,cAAA,EAAA,QAAQ,YAAY,KAAK,KAAM,KAAK,UAAU,EAAE,SAASC,cAAAA,CAAI;AAAA,EACtE;AACF;AAAA,QAAA,IAAA;"}